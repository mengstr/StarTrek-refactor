270 Z$="                         "
330 DIM G(8,8),C(9,2),K(3,3),N(3),Z(8,8),D(8)
370 T=INT(RND(1)*20+20)*100
371 T0=T
372 T9=25+INT(RND(1)*10)
373 D0=0
374 E=3000
375 E0=E
440 P=10
441 P0=P
442 S9=200
443 S=0
444 B9=0
445 K9=0
446 X$=""
447 X0$=" IS "
470 DEF FND(D)=SQR((K(I,1)-S1)^2+(K(I,2)-S2)^2)
490 Q1=INT(RND(1)*8+1)
491 Q2=INT(RND(1)*8+1)
492 S1=INT(RND(1)*8+1)
493 S2=INT(RND(1)*8+1)
530 FOR I=1 TO 9
531 C(I,1)=0
532 C(I,2)=0
533 NEXT I
540 C(3,1)=-1
541 C(2,1)=-1
542 C(4,1)=-1
543 C(4,2)=-1
544 C(5,2)=-1
545 C(6,2)=-1
600 C(1,2)=1
601 C(2,2)=1
602 C(6,1)=1
603 C(7,1)=1
604 C(8,1)=1
605 C(8,2)=1
606 C(9,2)=1
670 FOR I=1 TO 8
671 D(I)=0
672 NEXT I
710 A1$="NAVSRSLRSPHATORSHEDAMCOMXXX"
820 FOR I=1 TO 8
821 FOR J=1 TO 8
822 K3=0
823 Z(I,J)=0
824 R1=RND(1)
850 IF R1>.98 THEN K3=3:K9=K9+3:GOTO 980
860 IF R1>.95 THEN K3=2:K9=K9+2:GOTO 980
870 IF R1>.8 THEN K3=1:K9=K9+1
980 B3=0
981 IF RND(1)>.96 THEN B3=1:B9=B9+1
1040 G(I,J)=K3*100+B3*10+INT(RND(1)*8+1)
1041 NEXT J
1042 NEXT I
1043 IF K9>T9 THEN T9=K9+1
1100 IF B9<>0 THEN GOTO 1200
1150 IF G(Q1,Q2)<200 THEN G(Q1,Q2)=G(Q1,Q2)+100:K9=K9+1
1160 B9=1
1161 G(Q1,Q2)=G(Q1,Q2)+10
1162 Q1=INT(RND(1)*8+1)
1163 Q2=INT(RND(1)*8+1)
1200 K7=K9
1201 IF B9<>1 THEN X$="S":X0$=" ARE "
1230 PRINT"YOUR ORDERS ARE AS FOLLOWS:"
1235 PRINT "--------------------------"
1240 PRINT"   DESTROY THE";K9;"KLINGON WARSHIPS WHICH HAVE INVADED"
1250 PRINT"   THE GALAXY BEFORE THEY CAN ATTACK FEDERATION HEADQUARTERS"
1260 PRINT"   ON STARDATE";T0+T9;". THIS GIVES YOU";T9;"DAYS. THERE";X0$
1270 PRINT"  ";B9;"STARBASE";X$;" IN THE GALAXY FOR RESUPPLYING YOUR SHIP."
1280 PRINT
1310 REM
1320 Z4=Q1
1321 Z5=Q2
1322 K3=0
1323 B3=0
1324 S3=0
1325 G5=0
1326 D4=.5*RND(1)
1327 Z(Q1,Q2)=G(Q1,Q2)
1390 IF Q1<1 OR Q1>8 OR Q2<1 OR Q2>8 THEN GOTO 1600
1430 GOSUB 9030
1431 PRINT
1432 IF T0<>T THEN GOTO 1490
1460 PRINT"YOUR MISSION BEGINS WITH YOUR STARSHIP LOCATED"
1470 PRINT"IN THE GALACTIC QUADRANT, '";G2$;"'."
1471 GOTO 1500
1490 PRINT"NOW ENTERING ";G2$;" QUADRANT . . ."
1500 PRINT
1501 K3=INT(G(Q1,Q2)*.01)
1502 B3=INT(G(Q1,Q2)*.1)-10*K3
1540 S3=G(Q1,Q2)-100*K3-10*B3
1541 IF K3=0 THEN GOTO 1590
1560 PRINT TAB(3);"  COMBAT AREA      CONDITION RED  "
1561 IF S>200 THEN PRINT:GOTO 1590
1580 PRINT TAB(3);"      SHIELDS DANGEROUSLY LOW     "
1581 PRINT
1590 FOR I=1 TO 3
1591 K(I,1)=0
1592 K(I,2)=0
1593 NEXT I
1600 FOR I=1 TO 3
1601 K(I,3)=0
1602 NEXT I
1603 Q$=Z$+Z$+Z$+Z$+Z$+Z$+Z$+LEFT$(Z$,17)
1680 A$="<E>"
1681 Z1=S1
1682 Z2=S2
1683 GOSUB 8670
1684 IF K3<1 THEN GOTO 1820
1720 FOR I=1 TO K3
1721 GOSUB 8590
1722 A$="+K+"
1723 Z1=R1
1724 Z2=R2
1780 GOSUB 8670
1781 K(I,1)=R1
1782 K(I,2)=R2
1783 K(I,3)=S9*(.5+RND(1))
1784 NEXT I
1820 IF B3<1 THEN GOTO 1910
1880 GOSUB 8590
1881 A$=">B<"
1882 Z1=R1
1883 B4=R1
1884 Z2=R2
1885 B5=R2
1886 GOSUB 8670
1910 FOR I=1 TO S3
1911 GOSUB 8590
1912 A$=" * "
1913 Z1=R1
1914 Z2=R2
1915 GOSUB 8670
1916 NEXT I
1980 GOSUB 6430
1990 IF S+E>10 THEN IF E>10 OR D(7)=0 THEN GOTO 2060
2020 PRINT
2021 PRINT TAB(10);"** FATAL ERROR **"
2022 PRINT"YOU'VE JUST STRANDED YOUR SHIP IN SPACE."
2030 PRINT"YOU HAVE INSUFFICIENT MANEUVERING ENERGY,"
2040 PRINT"AND SHIELD CONTROL IS PRESENTLY INCAPABLE OF"
2050 PRINT"CROSS-CIRCUITING TO ENGINE ROOM!!"
2051 PRINT
2052 GOTO 6220
2060 PRINT
2061 INPUT"COMMAND";A$
2062 PRINT
2080 FOR I=1 TO 9
2081 IF LEFT$(A$,3)<>MID$(A1$,3*I-2,3)THEN GOTO 2160
2140 IF I=1 THEN GOTO 2300
2141 IF I=2 THEN GOTO 1980
2142 IF I=3 THEN GOTO 4000
2143 IF I=4 THEN GOTO 4260
2144 IF I=5 THEN GOTO 4700
2145 IF I=6 THEN GOTO 5530
2146 IF I=7 THEN GOTO 5690
2147 IF I=8 THEN GOTO 7290
2148 IF I=9 THEN GOTO 6270
2160 NEXT I
2161 PRINT"ENTER ONE OF THE FOLLOWING:"
2170 PRINT "--------------------------"
2180 PRINT"  NAV  (TO SET COURSE)"
2190 PRINT"  SRS  (FOR SHORT RANGE SENSOR SCAN)"
2200 PRINT"  LRS  (FOR LONG RANGE SENSOR SCAN)"
2210 PRINT"  PHA  (TO FIRE PHASERS)"
2220 PRINT"  TOR  (TO FIRE PHOTON TORPEDOES)"
2230 PRINT"  SHE  (TO RAISE OR LOWER SHIELDS)"
2240 PRINT"  DAM  (FOR DAMAGE CONTROL REPORTS)"
2250 PRINT"  COM  (TO CALL ON LIBRARY-COMPUTER)"
2260 PRINT"  XXX  (TO RESIGN YOUR COMMAND)":PRINT
2261 GOTO 1990
2300 INPUT"COURSE (0-9)";C1
2301 IF C1=9 THEN C1=1
2310 IF C1>=1 AND C1<9 THEN GOTO 2350
2330 PRINT"   LT. SULU: 'INCORRECT COURSE DATA, SIR!'"
2331 GOTO 1990
2350 X$="8"
2351 IF D(1)<0 THEN X$="0.2"
2360 PRINT"WARP FACTOR (0-";X$;")";
2361 INPUT W1
2362 PRINT
2363 IF D(1)<0 AND W1>.2 THEN GOTO 2470
2380 IF W1>0 AND W1<=8 THEN GOTO 2490
2390 IF W1=0 THEN GOTO 1990
2420 PRINT"   CHIEF ENGINEER SCOTT: 'THE ENGINES WON'T TAKE";
2430 PRINT" WARP";W1;"!'"
2431 GOTO 1990
2470 PRINT"WARP ENGINES ARE DAMAGED.  MAXIUM SPEED = WARP 0.2"
2471 GOTO 1990
2490 N=INT(W1*8+.5)
2491 IF E-N>=0 THEN GOTO 2590
2500 PRINT"ENGINEERING: 'INSUFFICIENT ENERGY AVAILABLE"
2510 PRINT"               FOR MANEUVERING AT WARP";W1;"!'"
2530 IF S<N-E OR D(7)<0 THEN GOTO 1990
2550 PRINT"DEFLECTOR CONTROL ROOM:  ";S;"UNITS OF ENERGY"
2560 PRINT"                          PRESENTLY DEPLOYED TO SHIELDS."
2570 GOTO 1990
2590 FOR I=1 TO K3
2591 IF K(I,3)=0 THEN GOTO 2700
2610 A$="   "
2611 Z1=K(I,1)
2612 Z2=K(I,2)
2613 GOSUB 8670
2614 GOSUB 8590
2660 K(I,1)=Z1
2661 K(I,2)=Z2
2662 A$="+K+"
2663 GOSUB 8670
2700 NEXT I
2701 GOSUB 6000
2702 D1=0
2703 D6=W1
2704 IF W1>=1 THEN D6=1
2770 FOR I=1 TO 8
2771 IF D(I)>=0 THEN GOTO 2880
2790 D(I)=D(I)+D6
2791 IF D(I)>-.1 AND D(I)<0 THEN D(I)=-.1:GOTO 2880
2800 IF D(I)<0 THEN GOTO 2880
2810 IF D1<>1 THEN D1=1:PRINT"DAMAGE CONTROL REPORT:  ";
2840 PRINT TAB(8);
2841 R1=I
2842 GOSUB 8790
2843 PRINT G2$;" REPAIR COMPLETED."
2880 NEXT I
2881 IF RND(1)>.2 THEN GOTO 3070
2910 R1=INT(RND(1)*8+1)
2911 IF RND(1)>=.6 THEN GOTO 3000
2930 D(R1)=D(R1)-(RND(1)*5+1)
2931 PRINT"DAMAGE CONTROL REPORT: ";
2960 GOSUB 8790
2961 PRINT G2$;" DAMAGED"
2962 PRINT
2963 GOTO 3070
3000 D(R1)=D(R1)+RND(1)*3+1
3001 PRINT"DAMAGE CONTROL REPORT:  ";
3030 GOSUB 8790
3031 PRINT G2$;" STATE OF REPAIR IMPROVED"
3032 PRINT
3070 A$="   "
3071 Z1=INT(S1)
3072 Z2=INT(S2)
3073 GOSUB 8670
3110 X1=C(C1,1)+(C(C1+1,1)-C(C1,1))*(C1-INT(C1))
3111 X=S1
3112 Y=S2
3140 X2=C(C1,2)+(C(C1+1,2)-C(C1,2))*(C1-INT(C1))
3141 Q4=Q1
3142 Q5=Q2
3170 FOR I=1 TO N
3171 S1=S1+X1
3172 S2=S2+X2
3173 IF S1<1 OR S1>=9 OR S2<1 OR S2>=9 THEN GOTO 3500
3240 S8=INT(S1)*24+INT(S2)*3-26
3241 IF MID$(Q$,S8,2)="  "THEN GOTO 3360
3320 S1=INT(S1-X1)
3321 S2=INT(S2-X2)
3322 PRINT"WARP ENGINES SHUT DOWN AT ";
3350 PRINT"SECTOR";S1;;",";S2;"DUE TO BAD NAVAGATION"
3351 GOTO 3370
3360 NEXT I
3361 S1=INT(S1)
3362 S2=INT(S2)
3370 A$="<E>"
3371 Z1=INT(S1)
3372 Z2=INT(S2)
3373 GOSUB 8670
3374 GOSUB 3910
3375 T8=1
3430 IF W1<1 THEN T8=.1*INT(10*W1)
3450 T=T+T8
3451 IF T>T0+T9 THEN GOTO 6220
3480 GOTO 1980
3500 X=8*Q1+X+N*X1
3501 Y=8*Q2+Y+N*X2
3502 Q1=INT(X/8)
3503 Q2=INT(Y/8)
3504 S1=INT(X-Q1*8)
3550 S2=INT(Y-Q2*8)
3551 IF S1=0 THEN Q1=Q1-1:S1=8
3590 IF S2=0 THEN Q2=Q2-1:S2=8
3620 X5=0
3621 IF Q1<1 THEN X5=1:Q1=1:S1=1
3670 IF Q1>8 THEN X5=1:Q1=8:S1=8
3710 IF Q2<1 THEN X5=1:Q2=1:S2=1
3750 IF Q2>8 THEN X5=1:Q2=8:S2=8
3790 IF X5=0 THEN GOTO 3860
3800 PRINT"LT. UHURA: MESSAGE FROM STARFLEET COMMAND --"
3810 PRINT"  'PERMISSION TO ATTEMPT CROSSING OF GALACTIC PERIMETER"
3820 PRINT"  IS HEREBY *DENIED*.  SHUT DOWN YOUR ENGINES.'"
3830 PRINT"CHIEF ENGINEER SCOTT:  'WARP ENGINES SHUT DOWN"
3840 PRINT"  AT SECTOR";S1;",";S2;"OF QUADRANT";Q1;",";Q2;".'"
3850 IF T>T0+T9 THEN GOTO 6220
3860 IF 8*Q1+Q2=8*Q4+Q5 THEN GOTO 3370
3870 T=T+1
3871 GOSUB 3910
3872 GOTO 1320
3910 E=E-N-10
3911 IF E>=0 THEN RETURN
3930 PRINT"SHIELD CONTROL SUPPLIES ENERGY TO COMPLETE THE MANEUVER."
3940 S=S+E
3941 E=0
3942 IF S<=0 THEN S=0
3980 RETURN
4000 IF D(3)<0 THEN PRINT"LONG RANGE SENSORS ARE INOPERABLE.":GOTO 1990
4030 PRINT"LONG RANGE SCAN FOR QUADRANT";Q1;",";Q2
4031 PRINT
4040 O1$="-------------------"
4041 PRINT O1$
4060 FOR I=Q1-1 TO Q1+1
4061 N(1)=-1
4062 N(2)=-2
4063 N(3)=-3
4064 FOR J=Q2-1 TO Q2+1
4120 IF I>0 AND I<9 AND J>0 AND J<9 THEN N(J-Q2+2)=G(I,J):Z(I,J)=G(I,J)
4180 NEXT J
4181 FOR L=1 TO 3
4182 PRINT"| ";
4183 IF N(L)<0 THEN PRINT"*** ";:GOTO 4230
4210 PRINT RIGHT$(STR$(N(L)+1000),3);" ";
4230 NEXT L
4231 PRINT"|"
4232 PRINT O1$
4233 NEXT I
4234 GOTO 1990
4260 IF D(4)<0 THEN PRINT"PHASERS INOPERATIVE.":GOTO 1990
4265 IF K3>0 THEN GOTO 4330
4270 PRINT"SCIENCE OFFICER SPOCK:  'SENSORS SHOW NO ENEMY SHIPS"
4280 PRINT"                         IN THIS QUADRANT'"
4281 GOTO 1990
4330 IF D(8)<0 THEN PRINT"COMPUTER FAILURE HAMPERS ACCURACY."
4350 PRINT"PHASERS LOCKED ON TARGET;  ";
4360 PRINT"ENERGY AVAILABLE =";E;"UNITS"
4370 INPUT"NUMBER OF UNITS TO FIRE";X
4371 IF X<=0 THEN GOTO 1990
4400 IF E-X<0 THEN GOTO 4360
4410 E=E-X
4411 IF D(7)<0 THEN X=X*RND(1)
4450 H1=INT(X/K3)
4451 FOR I=1 TO 3
4452 IF K(I,3)<=0 THEN GOTO 4670
4480 H=INT((H1/FND(0))*(RND(1)+2))
4481 IF H>.15*K(I,3)THEN GOTO 4530
4500 PRINT"SENSORS SHOW NO DAMAGE TO ENEMY AT";K(I,1);",";K(I,2);"."
4501 GOTO 4670
4530 K(I,3)=K(I,3)-H
4531 PRINT H;"UNIT HIT ON KLINGON AT SECTOR";K(I,1);",";
4550 PRINT K(I,2);"."
4551 IF K(I,3)<=0 THEN PRINT:PRINT "*** KLINGON DESTROYED ***":PRINT:GOTO 4580
4560 PRINT" (SENSORS SHOW";K(I,3);"UNITS REMAINING)"
4561 GOTO 4670
4580 K3=K3-1
4581 K9=K9-1
4582 Z1=K(I,1)
4583 Z2=K(I,2)
4584 A$="   "
4585 GOSUB 8670
4650 K(I,3)=0
4651 G(Q1,Q2)=G(Q1,Q2)-100
4652 Z(Q1,Q2)=G(Q1,Q2)
4653 IF K9<=0 THEN GOTO 6370
4670 NEXT I
4671 GOSUB 6000
4672 GOTO 1990
4700 IF P<=0 THEN PRINT"ALL PHOTON TORPEDOES EXPENDED.":GOTO 1990
4730 IF D(5)<0 THEN PRINT"PHOTON TUBES ARE NOT OPERATIONAL.":GOTO 1990
4760 INPUT"PHOTON TORPEDO COURSE (1-9)";C1
4761 IF C1=9 THEN C1=1
4780 IF C1>=1 AND C1<9 THEN GOTO 4850
4790 PRINT"ENSIGN CHEKOV:  'INCORRECT COURSE DATA, SIR!'"
4800 GOTO 1990
4850 X1=C(C1,1)+(C(C1+1,1)-C(C1,1))*(C1-INT(C1))
4851 E=E-2
4852 P=P-1
4860 X2=C(C1,2)+(C(C1+1,2)-C(C1,2))*(C1-INT(C1))
4861 X=S1
4862 Y=S2
4910 PRINT"TORPEDO TRACK:"
4920 X=X+X1
4921 Y=Y+X2
4922 X3=INT(X+.5)
4923 Y3=INT(Y+.5)
4960 IF X3<1 OR X3>8 OR Y3<1 OR Y3>8 THEN GOTO 5490
5000 PRINT"               ";X3;",";Y3
5001 A$="   "
5002 Z1=X
5003 Z2=Y
5004 GOSUB 8830
5050 IF Z3<>0 THEN GOTO 4920
5060 A$="+K+"
5061 Z1=X
5062 Z2=Y
5063 GOSUB 8830
5064 IF Z3=0 THEN GOTO 5210
5110 PRINT
5111 PRINT "*** KLINGON DESTROYED ***"
5112 PRINT
5113 K3=K3-1
5114 K9=K9-1
5115 IF K9<=0 THEN GOTO 6370
5150 FOR I=1 TO 3
5151 IF X3=K(I,1)AND Y3=K(I,2)THEN GOTO 5190
5180 NEXT I
5181 I=3
5190 K(I,3)=0
5191 GOTO 5430
5210 A$=" * "
5211 Z1=X
5212 Z2=Y
5213 GOSUB 8830
5214 IF Z3=0 THEN GOTO 5280
5260 PRINT"STAR AT";X3;",";Y3;"ABSORBED TORPEDO ENERGY."
5261 GOSUB 6000
5262 GOTO 1990
5280 A$=">B<"
5281 Z1=X
5282 Z2=Y
5283 GOSUB 8830
5284 IF Z3=0 THEN GOTO 4760 REM Use ">B<" to match placed base symbol
5330 PRINT "*** STARBASE DESTROYED ***"
5331 B3=B3-1
5332 B9=B9-1
5360 IF B9>0 OR K9>T-T0-T9 THEN GOTO 5400
5370 PRINT"THAT DOES IT, CAPTAIN!!  YOU ARE HEREBY RELIEVED OF COMMAND"
5380 PRINT"AND SENTENCED TO 99 STARDATES AT HARD LABOR ON CYGNUS 12!!"
5390 GOTO 6270
5400 PRINT"STARFLEET COMMAND REVIEWING YOUR RECORD TO CONSIDER"
5410 PRINT"COURT MARTIAL!"
5411 D0=0
5430 Z1=X
5431 Z2=Y
5432 A$="   "
5433 GOSUB 8670
5470 G(Q1,Q2)=K3*100+B3*10+S3
5471 Z(Q1,Q2)=G(Q1,Q2)
5472 GOSUB 6000
5473 GOTO 1990
5490 PRINT"TORPEDO MISSED."
5491 PRINT
5492 GOSUB 6000
5493 GOTO 1990
5530 IF D(7)<0 THEN PRINT"SHIELD CONTROL INOPERABLE.":GOTO 1990
5560 PRINT"ENERGY AVAILABLE =";E+S;
5561 INPUT"NUMBER OF UNITS TO SHIELDS";X
5580 IF X<0 OR S=X THEN PRINT"<SHIELDS UNCHANGED>":GOTO 1990
5590 IF X<=E+S THEN GOTO 5630
5600 PRINT"SHIELD CONTROL:  'THIS IS NOT THE FEDERATION TREASURY.'" 
5610 PRINT"<SHIELDS UNCHANGED>"
5611 GOTO 1990
5630 E=E+S-X
5631 S=X
5632 PRINT"DEFLECTOR CONTROL ROOM:"
5660 PRINT"  'SHIELDS NOW AT";INT(S);"UNITS PER YOUR COMMAND.'"
5661 GOTO 1990
5690 IF D(6)>=0 THEN GOTO 5910
5700 PRINT"DAMAGE CONTROL REPORT NOT AVAILABLE."
5701 IF D0=0 THEN GOTO 1990
5720 D3=0
5721 FOR I=1 TO 8
5722 IF D(I)<0 THEN D3=D3+.1
5760 NEXT I
5761 IF D3=0 THEN GOTO 1990
5780 PRINT
5781 D3=D3+D4
5782 IF D3>=1 THEN D3=.9
5810 PRINT"TECHNICIANS STANDING BY TO EFFECT REPAIRS TO YOUR SHIP;"
5820 PRINT"ESTIMATED TIME TO REPAIR:";.01*INT(100*D3);"STARDATES."
5840 INPUT"WILL YOU AUTHORIZE THE REPAIR ORDER (Y/N)";A$
5860 IF A$<>"Y"THEN GOTO 1990
5870 FOR I=1 TO 8
5871 IF D(I)<0 THEN D(I)=0
5890 NEXT I
5891 T=T+D3+.1
5910 PRINT
5911 PRINT"DEVICE             STATE OF REPAIR"
5912 PRINT"------             ---------------"
5913 FOR R1=1 TO 8
5920 GOSUB 8790
5921 PRINT G2$;LEFT$(Z$,25-LEN(G2$));INT(D(R1)*100)*.01
5950 NEXT R1
5951 PRINT
5952 IF D0<>0 THEN GOTO 5720
5980 GOTO 1990
6000 IF K3<=0 THEN RETURN
6010 IF D0<>0 THEN PRINT"STARBASE SHIELDS PROTECT THE ENTERPRISE.":RETURN
6040 FOR I=1 TO 3
6041 IF K(I,3)<=0 THEN GOTO 6200
6060 H=INT((K(I,3)/FND(1))*(2+RND(1)))
6061 S=S-H
6062 K(I,3)=K(I,3)/(3+RND(0))
6080 PRINT
6081 PRINT H;"UNIT HIT ON ENTERPRISE FROM SECTOR";K(I,1);",";K(I,2);"."
6090 IF S<=0 THEN GOTO 6240
6100 PRINT"      <SHIELDS DOWN TO";S;"UNITS>"
6101 IF H<20 THEN GOTO 6200
6120 IF RND(1)>.6 OR H/S<=.02 THEN GOTO 6200
6140 R1=INT(RND(1)*8+1)
6141 D(R1)=D(R1)-H/S-.5*RND(1)
6142 GOSUB 8790
6170 PRINT"DAMAGE CONTROL: '";G2$;" DAMAGED BY THE HIT'"
6200 NEXT I
6201 RETURN
6220 PRINT
6221 PRINT"IT IS STARDATE";T;"."
6222 PRINT
6223 GOTO 6270
6240 PRINT
6241 PRINT"THE ENTERPRISE HAS BEEN DESTROYED.  THE FEDERATION ";
6250 PRINT"WILL BE CONQUERED."
6251 GOTO 6220
6270 PRINT"THERE WERE";K9;"KLINGON BATTLE CRUISERS LEFT AT"
6280 PRINT"THE END OF YOUR MISSION."
6290 PRINT
6291 PRINT
6292 IF B9=0 THEN GOTO 6360
6310 REM
6320 REM
6330 REM
6331 REM
6360 END
6370 PRINT"CONGRATULATIONS, CAPTAIN!  THE LAST KLINGON BATTLE CRUISER"
6380 PRINT"MENACING THE FEDERATION HAS BEEN DESTROYED."
6381 PRINT
6400 PRINT"YOUR EFFICIENCY RATING IS";1000*(K7/(T-T0))^2
6401 GOTO 6290
6430 FOR I=S1-1 TO S1+1
6431 FOR J=S2-1 TO S2+1
6450 IF INT(I+.5)<1 OR INT(I+.5)>8 OR INT(J+.5)<1 OR INT(J+.5)>8 THEN GOTO 6540
6490 A$=">B<"
6491 Z1=I
6492 Z2=J
6493 GOSUB 8830
6494 IF Z3=1 THEN GOTO 6580
6540 NEXT J
6541 NEXT I
6542 D0=0
6543 GOTO 6650
6580 D0=1
6581 C$="DOCKED"
6582 E=E0
6583 P=P0
6620 PRINT"SHIELDS DROPPED FOR DOCKING PURPOSES."
6621 S=0
6622 GOTO 6720
6650 IF K3>0 THEN C$="*RED*":GOTO 6720
6660 C$="GREEN"
6661 IF E<E0*.1 THEN C$="YELLOW"
6720 IF D(2)>=0 THEN GOTO 6770
6730 PRINT
6731 PRINT"*** SHORT RANGE SENSORS ARE OUT ***"
6732 PRINT
6733 RETURN
6770 O1$="   +--1---2---3---4---5---6---7---8-+"
6771 PRINT O1$
6772 FOR I=1 TO 8
6773 PRINT I;"|";
6820 FOR J=(I-1)*24+1 TO(I-1)*24+22 STEP 3
6821 PRINT" ";MID$(Q$,J,3);
6822 NEXT J
6823 PRINT"|";I;
6830 IF I=1 THEN GOTO 6850
6831 IF I=2 THEN GOTO 6900
6832 IF I=3 THEN GOTO 6960
6833 IF I=4 THEN GOTO 7020
6834 IF I=5 THEN GOTO 7070
6835 IF I=6 THEN GOTO 7120
6836 IF I=7 THEN GOTO 7180
6837 IF I=8 THEN GOTO 7240
6850 PRINT"        STARDATE           ";INT(T*10)*.1
6852 GOTO 7260
6900 PRINT"        CONDITION          ";C$
6902 GOTO 7260
6960 PRINT"        QUADRANT           ";Q1;",";Q2
6961 GOTO 7260
7020 PRINT"        SECTOR             ";S1;",";S2
7021 GOTO 7260
7070 PRINT"        PHOTON TORPEDOES   ";INT(P)
7072 GOTO 7260
7120 PRINT"        TOTAL ENERGY       ";INT(E+S)
7122 GOTO 7260
7180 PRINT"        SHIELDS            ";INT(S)
7182 GOTO 7260
7240 PRINT"        KLINGONS REMAINING";INT(K9)
7260 NEXT I
7261 PRINT O1$
7262 RETURN
7290 IF D(8)<0 THEN PRINT"COMPUTER DISABLED.":GOTO 1990
7320 INPUT"COMPUTER ACTIVE AND AWAITING COMMAND";A
7321 IF A<0 THEN GOTO 1990
7350 PRINT
7351 H8=1
7352 IF A+1=1 THEN GOTO 7540
7353 IF A+1=2 THEN GOTO 7900
7354 IF A+1=3 THEN GOTO 8070
7355 IF A+1=4 THEN GOTO 8500
7356 IF A+1=5 THEN GOTO 8150
7357 IF A+1=6 THEN GOTO 7400
7360 PRINT"FUNCTIONS AVAILABLE FROM LIBRARY-COMPUTER:"
7365 PRINT "-----------------------------------------"
7366 PRINT
7370 PRINT"   0 = CUMULATIVE GALTIC RECORD"
7372 PRINT"   1 = STATUS REPORT"
7374 PRINT"   2 = PHOTON TORPEDO DATA"
7376 PRINT"   3 = STARBASE NAV DATA"
7378 PRINT"   4 = DIRECTION/DISTANCE CALCULATOR"
7380 PRINT"   5 = GALAXY 'REGION NAME' MAP"
7381 PRINT
7382 GOTO 7320
7400 H8=0
7401 G5=1
7402 PRINT"                        THE GALAXY"
7403 GOTO 7550
7540 REM
7542 REM
7543 PRINT
7544 PRINT"       ";
7545 PRINT"COMPUTER RECORD OF GALAXY FOR QUADRANT";Q1;",";Q2
7546 PRINT
7550 PRINT"       1     2     3     4     5     6     7     8"
7560 O1$="    +-----+-----+-----+-----+-----+-----+-----+-----+"
7570 PRINT O1$
7571 FOR I=1 TO 8
7572 PRINT I;" ";
7573 IF H8=0 THEN GOTO 7740
7630 FOR J=1 TO 8
7631 PRINT"| ";
7632 IF Z(I,J)=0 THEN PRINT"*** ";:GOTO 7720
7700 PRINT RIGHT$(STR$(Z(I,J)+1000),3);" ";
7720 IF J=8 THEN PRINT "|"
7721 NEXT J
7722 GOTO 7850
7740 Z4=I
7741 Z5=1
7742 GOSUB 9030
7743 J0=INT(15-.5*LEN(G2$))
7744 PRINT TAB(J0);G2$;
7800 Z5=5
7801 GOSUB 9030
7802 J0=INT(39-.5*LEN(G2$))
7803 PRINT TAB(J0);G2$
7850 PRINT O1$
7851 NEXT I
7852 PRINT
7853 GOTO 1990
7900 PRINT "   STATUS REPORT:"
7901 PRINT "   -------------"
7902 X$=""
7903 IF K9>1 THEN X$="S"
7940 PRINT K9;"KLINGON";X$;" LEFT."
7960 PRINT" MISSION MUST BE COMPLETED IN";.1*INT((T0+T9-T)*10);"STARDATES."
7970 X$="S"
7971 IF B9<2 THEN X$="":IF B9<1 THEN GOTO 8010
7980 PRINT" THE FEDERATION IS MAINTAINING";B9;"STARBASE";X$;" IN THE GALAXY."
7990 GOTO 5690
8010 PRINT"YOUR STUPIDITY HAS LEFT YOU ON YOUR OWN IN"
8020 PRINT"  THE GALAXY -- YOU HAVE NO STARBASES LEFT!"
8021 GOTO 5690
8070 IF K3<=0 THEN GOTO 4270
8080 X$=""
8081 IF K3>1 THEN X$="S"
8090 PRINT"FROM ENTERPRISE TO KLINGON BATTLE CRUSER";X$
8100 H8=0
8101 FOR I=1 TO 3
8102 IF K(I,3)<=0 THEN GOTO 8480
8110 W1=K(I,1)
8111 X=K(I,2)
8120 C1=S1
8121 A=S2
8122 GOTO 8220
8150 PRINT"DIRECTION/DISTANCE CALCULATOR:"
8160 PRINT"YOU ARE AT QUADRANT ";Q1;",";Q2;" SECTOR ";S1;",";S2;"."
8170 INPUT"PLEASE ENTER INITIAL COORDINATES (X,Y)";C1,A
8200 INPUT"FINAL COORDINATES (X,Y)";W1,X
8220 X=X-A
8221 A=C1-W1
8222 IF X<0 THEN GOTO 8350
8250 IF A<0 THEN GOTO 8410
8260 IF X>0 THEN GOTO 8280
8270 IF A=0 THEN C1=5:GOTO 8290
8280 C1=1
8290 IF ABS(A)<=ABS(X)THEN GOTO 8330
8310 PRINT"DIRECTION =";C1+(((ABS(A)-ABS(X))+ABS(A))/ABS(A))
8311 GOTO 8460
8330 PRINT"DIRECTION =";C1+(ABS(A)/ABS(X))
8331 GOTO 8460
8350 IF A>0 THEN C1=3:GOTO 8420
8360 IF X<>0 THEN C1=5:GOTO 8290
8410 C1=7
8420 IF ABS(A)>=ABS(X)THEN GOTO 8450
8430 PRINT"DIRECTION =";C1+(((ABS(X)-ABS(A))+ABS(X))/ABS(X))
8431 GOTO 8460
8450 PRINT"DIRECTION =";C1+(ABS(X)/ABS(A))
8460 PRINT"DISTANCE =";SQR(X^2+A^2)
8461 IF H8=1 THEN GOTO 1990
8480 NEXT I
8481 GOTO 1990
8500 IF B3<>0 THEN PRINT"FROM ENTERPRISE TO STARBASE:":W1=B4:X=B5:GOTO 8120
8510 PRINT"MR. SPOCK:  'SENSORS SHOW NO STARBASES IN THIS QUADRANT.'";
8520 GOTO 1990
8590 R1=INT(RND(1)*8+1)
8591 R2=INT(RND(1)*8+1)
8592 A$="   "
8593 Z1=R1
8594 Z2=R2
8595 GOSUB 8830
8596 IF Z3=0 THEN GOTO 8590
8600 RETURN
8670 S8=INT(Z2-.5)*3+INT(Z1-.5)*24+1
8675 IF LEN(A$)<>3 THEN PRINT"ERROR":STOP
8680 IF S8=1 THEN Q$=A$+RIGHT$(Q$,189):RETURN
8690 IF S8=190 THEN Q$=LEFT$(Q$,189)+A$:RETURN
8700 Q$=LEFT$(Q$,S8-1)+A$+RIGHT$(Q$,190-S8)
8701 RETURN
8790 IF R1=1 THEN GOTO 8800
8791 IF R1=2 THEN GOTO 8802
8792 IF R1=3 THEN GOTO 8804
8793 IF R1=4 THEN GOTO 8806
8794 IF R1=5 THEN GOTO 8808
8795 IF R1=6 THEN GOTO 8810
8796 IF R1=7 THEN GOTO 8812
8797 IF R1=8 THEN GOTO 8814
8800 G2$="WARP ENGINES"
8801 RETURN
8802 G2$="SHORT RANGE SENSORS"
8803 RETURN
8804 G2$="LONG RANGE SENSORS"
8805 RETURN
8806 G2$="PHASER CONTROL"
8807 RETURN
8808 G2$="PHOTON TUBES"
8809 RETURN
8810 G2$="DAMAGE CONTROL"
8811 RETURN
8812 G2$="SHIELD CONTROL"
8813 RETURN
8814 G2$="LIBRARY-COMPUTER"
8815 RETURN
8830 Z1=INT(Z1+.5)
8831 Z2=INT(Z2+.5)
8832 S8=(Z2-1)*3+(Z1-1)*24+1
8833 Z3=0
8890 IF MID$(Q$,S8,3)<>A$THEN RETURN
8900 Z3=1
8901 RETURN
9030 IF Z5>4 THEN GOTO 9120
9031 IF Z4=1 THEN GOTO 9040
9032 IF Z4=2 THEN GOTO 9050
9033 IF Z4=3 THEN GOTO 9060
9034 IF Z4=4 THEN GOTO 9070
9035 IF Z4=5 THEN GOTO 9080
9036 IF Z4=6 THEN GOTO 9090
9037 IF Z4=7 THEN GOTO 9100
9038 IF Z4=8 THEN GOTO 9110
9040 G2$="ANTARES"
9041 GOTO 9210
9050 G2$="RIGEL"
9051 GOTO 9210
9060 G2$="PROCYON"
9061 GOTO 9210
9070 G2$="VEGA"
9071 GOTO 9210
9080 G2$="CANOPUS"
9081 GOTO 9210
9090 G2$="ALTAIR"
9091 GOTO 9210
9100 G2$="SAGITTARIUS"
9101 GOTO 9210
9110 G2$="POLLUX"
9111 GOTO 9210
9120 IF Z4=1 THEN GOTO 9130
9121 IF Z4=2 THEN GOTO 9140
9122 IF Z4=3 THEN GOTO 9150
9123 IF Z4=4 THEN GOTO 9160
9124 IF Z4=5 THEN GOTO 9170
9125 IF Z4=6 THEN GOTO 9180
9126 IF Z4=7 THEN GOTO 9190
9127 IF Z4=8 THEN GOTO 9200
9130 G2$="SIRIUS"
9131 GOTO 9210
9140 G2$="DENEB"
9141 GOTO 9210
9150 G2$="CAPELLA"
9151 GOTO 9210
9160 G2$="BETELGEUSE"
9161 GOTO 9210
9170 G2$="ALDEBARAN"
9171 GOTO 9210
9180 G2$="REGULUS"
9181 GOTO 9210
9190 G2$="ARCTURUS"
9191 GOTO 9210
9200 G2$="SPICA"
9210 IF G5=1 THEN RETURN
9211 IF Z5=1 THEN GOTO 9230
9212 IF Z5=2 THEN GOTO 9240
9213 IF Z5=3 THEN GOTO 9250
9214 IF Z5=4 THEN GOTO 9260
9215 IF Z5=5 THEN GOTO 9230
9216 IF Z5=6 THEN GOTO 9240
9217 IF Z5=7 THEN GOTO 9250
9218 IF Z5=8 THEN GOTO 9260
9220 RETURN
9230 G2$=G2$+" I"
9231 RETURN
9240 G2$=G2$+" II"
9241 RETURN
9250 G2$=G2$+" III"
9251 RETURN
9260 G2$=G2$+" IV"
9261 RETURN
9999 END
